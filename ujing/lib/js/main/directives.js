!function(n,e){define(["angular"],function(n){"use strict";n.module("mApp.directives",["mApp.services"]).directive("ngOnload",["$log",function(e){return{scope:{ngOnload:"="},link:function(t,i){t.$watch("ngOnload",function(a){e.debug(a),n.isFunction(a)&&i.bind("load",function(n){t.ngOnload(n)})})}}}]).directive("whenActive",function(n,e){return{scope:!0,link:function(t,i){n.$on("$stateChangeSuccess",function(){i.attr("href").match(e.$$path)?i.addClass("active"):i.removeClass("active")})}}}).directive("mcSwitch",function(){return{scope:{mcSwitch:"="},template:'<a class="mc-switch" ng-class="{active: mcSwitch}" ng-click="toggle()"><span class="toggle"></span></a>',link:function(n){n.toggle=function(){n.mcSwitch=!n.mcSwitch}}}}).directive("collapse",["$transition",function(n){return{link:function(e,t,i){function a(e){function i(){r===a&&(r=void 0)}var a=n(t,e);return r&&r.cancel(),r=a,a.then(i,i),a}function c(){g?(g=!1,o()):(t.removeClass("collapse").addClass("collapsing"),a({height:t[0].scrollHeight+"px"}).then(o))}function o(){t.removeClass("collapsing"),t.addClass("collapse in"),t.css({height:"auto"})}function l(){g?(g=!1,s(),t.css({height:0})):(t.css({height:t[0].scrollHeight+"px"}),t.removeClass("collapse in").addClass("collapsing"),a({height:0}).then(s))}function s(){t.removeClass("collapsing"),t.addClass("collapse")}var r,g=!0;e.$watch(i.collapse,function(n){n?c():l()})}}}]).directive("preview",["picture","$timeout",function(e,t){return{restrict:"E",templateUrl:"lib/template/preview.html",scope:{src:"=",isShowBtns:"=",tpl:"=",btnsTpl:"="},link:function(i,a){var c=n.element(window).width()||0,o=n.element(window).height()||0,l=0;t(function(){a.find("img").on("load",function(){var n=this.naturalWidth,e=this.naturalHeight,t=e/n;l=(o-c*t)/2,a.find(".scroll").css({height:o}),a.find("img").css({"-webkit-transform":"translate3d(0, "+l+"px, 0)"})})},0),i.delPicture=function(n,t){e.delPicture(n,t)},i.closePicture=function(){e.closePicture()}}}}]).directive("range",[function(){return{scope:{minRange:"=",maxRange:"=",range:"=?",onChanged:"&",rangeText:"@",formatter:"=?"},template:'<div class="range-content"><i class="range-value"></i><i class="range-handle"><span class="range-text" ng-if="rangeShow">{{formatter(range)}}</span></i></div>',link:function(n,e,t){function i(n){o||(o=e.find(".range-handle"),l=o.width()),c||(c=e.find(".range-value")),c.css("right",100*(1-(n-s)/g)+"%"),o.css("left",(n-s)/g*100+"%")}function a(e){var t,a=e.originalEvent.changedTouches[0],c=a.clientX;f=u.width(),h=u.offset().left,t=(c-h)/f*g+s,t=t||s,t=t<s?s:t>r?r:t,i(t),n.range=t,n.$apply()}var c,o,l,s=n.minRange||0,r=n.maxRange||100,g=r-s,u=e.find(".range-content"),f=u.width(),h=u.offset().left;n.rangeShow="false"!==n.rangeText&&n.rangeText!==!1,n.$watch("range",function(e){e?e>r&&(n.range=r):n.range=s,i(e)}),n.$watch("formatter",function(e){e||(n.formatter=function(n){return n})}),e.delegate(".range-handle","touchmove",function(n){a(n)}),e.delegate(".range-handle","touchend",function(e){a(e),n.onChanged.call(n,{$event:n.range})})}}}])}),e[""]=n}({},function(){return this}());